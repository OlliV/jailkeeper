#ifndef CHECKER_H
#define CHECKER_H

#include "jailkeeper.h"

#define WEAKCHK_PROTO(x) int _sysrulecheck_##x(RULE_CHECKER_ARGS) __attribute__((weak))
#define WEAKCHK(x) _sysrulecheck_##x

WEAKCHK_PROTO(0);
WEAKCHK_PROTO(1);
WEAKCHK_PROTO(2);
WEAKCHK_PROTO(3);
WEAKCHK_PROTO(4);
WEAKCHK_PROTO(5);
WEAKCHK_PROTO(6);
WEAKCHK_PROTO(7);
WEAKCHK_PROTO(8);
WEAKCHK_PROTO(9);
WEAKCHK_PROTO(10);
WEAKCHK_PROTO(11);
WEAKCHK_PROTO(12);
WEAKCHK_PROTO(13);
WEAKCHK_PROTO(14);
WEAKCHK_PROTO(15);
WEAKCHK_PROTO(16);
WEAKCHK_PROTO(17);
WEAKCHK_PROTO(18);
WEAKCHK_PROTO(19);
WEAKCHK_PROTO(20);
WEAKCHK_PROTO(21);
WEAKCHK_PROTO(22);
WEAKCHK_PROTO(23);
WEAKCHK_PROTO(24);
WEAKCHK_PROTO(25);
WEAKCHK_PROTO(26);
WEAKCHK_PROTO(27);
WEAKCHK_PROTO(28);
WEAKCHK_PROTO(29);
WEAKCHK_PROTO(30);
WEAKCHK_PROTO(31);
WEAKCHK_PROTO(32);
WEAKCHK_PROTO(33);
WEAKCHK_PROTO(34);
WEAKCHK_PROTO(35);
WEAKCHK_PROTO(36);
WEAKCHK_PROTO(37);
WEAKCHK_PROTO(38);
WEAKCHK_PROTO(39);
WEAKCHK_PROTO(40);
WEAKCHK_PROTO(41);
WEAKCHK_PROTO(42);
WEAKCHK_PROTO(43);
WEAKCHK_PROTO(44);
WEAKCHK_PROTO(45);
WEAKCHK_PROTO(46);
WEAKCHK_PROTO(47);
WEAKCHK_PROTO(48);
WEAKCHK_PROTO(49);
WEAKCHK_PROTO(50);
WEAKCHK_PROTO(51);
WEAKCHK_PROTO(52);
WEAKCHK_PROTO(53);
WEAKCHK_PROTO(54);
WEAKCHK_PROTO(55);
WEAKCHK_PROTO(56);
WEAKCHK_PROTO(57);
WEAKCHK_PROTO(58);
WEAKCHK_PROTO(59);
WEAKCHK_PROTO(60);
WEAKCHK_PROTO(61);
WEAKCHK_PROTO(62);
WEAKCHK_PROTO(63);
WEAKCHK_PROTO(64);
WEAKCHK_PROTO(65);
WEAKCHK_PROTO(66);
WEAKCHK_PROTO(67);
WEAKCHK_PROTO(68);
WEAKCHK_PROTO(69);
WEAKCHK_PROTO(70);
WEAKCHK_PROTO(71);
WEAKCHK_PROTO(72);
WEAKCHK_PROTO(73);
WEAKCHK_PROTO(74);
WEAKCHK_PROTO(75);
WEAKCHK_PROTO(76);
WEAKCHK_PROTO(77);
WEAKCHK_PROTO(78);
WEAKCHK_PROTO(79);
WEAKCHK_PROTO(80);
WEAKCHK_PROTO(81);
WEAKCHK_PROTO(82);
WEAKCHK_PROTO(83);
WEAKCHK_PROTO(84);
WEAKCHK_PROTO(85);
WEAKCHK_PROTO(86);
WEAKCHK_PROTO(87);
WEAKCHK_PROTO(88);
WEAKCHK_PROTO(89);
WEAKCHK_PROTO(90);
WEAKCHK_PROTO(91);
WEAKCHK_PROTO(92);
WEAKCHK_PROTO(93);
WEAKCHK_PROTO(94);
WEAKCHK_PROTO(95);
WEAKCHK_PROTO(96);
WEAKCHK_PROTO(97);
WEAKCHK_PROTO(98);
WEAKCHK_PROTO(99);
WEAKCHK_PROTO(100);
WEAKCHK_PROTO(101);
WEAKCHK_PROTO(102);
WEAKCHK_PROTO(103);
WEAKCHK_PROTO(104);
WEAKCHK_PROTO(105);
WEAKCHK_PROTO(106);
WEAKCHK_PROTO(107);
WEAKCHK_PROTO(108);
WEAKCHK_PROTO(109);
WEAKCHK_PROTO(110);
WEAKCHK_PROTO(111);
WEAKCHK_PROTO(112);
WEAKCHK_PROTO(113);
WEAKCHK_PROTO(114);
WEAKCHK_PROTO(115);
WEAKCHK_PROTO(116);
WEAKCHK_PROTO(117);
WEAKCHK_PROTO(118);
WEAKCHK_PROTO(119);
WEAKCHK_PROTO(120);
WEAKCHK_PROTO(121);
WEAKCHK_PROTO(122);
WEAKCHK_PROTO(123);
WEAKCHK_PROTO(124);
WEAKCHK_PROTO(125);
WEAKCHK_PROTO(126);
WEAKCHK_PROTO(127);
WEAKCHK_PROTO(128);
WEAKCHK_PROTO(129);
WEAKCHK_PROTO(130);
WEAKCHK_PROTO(131);
WEAKCHK_PROTO(132);
WEAKCHK_PROTO(133);
WEAKCHK_PROTO(134);
WEAKCHK_PROTO(135);
WEAKCHK_PROTO(136);
WEAKCHK_PROTO(137);
WEAKCHK_PROTO(138);
WEAKCHK_PROTO(139);
WEAKCHK_PROTO(140);
WEAKCHK_PROTO(141);
WEAKCHK_PROTO(142);
WEAKCHK_PROTO(143);
WEAKCHK_PROTO(144);
WEAKCHK_PROTO(145);
WEAKCHK_PROTO(146);
WEAKCHK_PROTO(147);
WEAKCHK_PROTO(148);
WEAKCHK_PROTO(149);
WEAKCHK_PROTO(150);
WEAKCHK_PROTO(151);
WEAKCHK_PROTO(152);
WEAKCHK_PROTO(153);
WEAKCHK_PROTO(154);
WEAKCHK_PROTO(155);
WEAKCHK_PROTO(156);
WEAKCHK_PROTO(157);
WEAKCHK_PROTO(158);
WEAKCHK_PROTO(159);
WEAKCHK_PROTO(160);
WEAKCHK_PROTO(161);
WEAKCHK_PROTO(162);
WEAKCHK_PROTO(163);
WEAKCHK_PROTO(164);
WEAKCHK_PROTO(165);
WEAKCHK_PROTO(166);
WEAKCHK_PROTO(167);
WEAKCHK_PROTO(168);
WEAKCHK_PROTO(169);
WEAKCHK_PROTO(170);
WEAKCHK_PROTO(171);
WEAKCHK_PROTO(172);
WEAKCHK_PROTO(173);
WEAKCHK_PROTO(174);
WEAKCHK_PROTO(175);
WEAKCHK_PROTO(176);
WEAKCHK_PROTO(177);
WEAKCHK_PROTO(178);
WEAKCHK_PROTO(179);
WEAKCHK_PROTO(180);
WEAKCHK_PROTO(181);
WEAKCHK_PROTO(182);
WEAKCHK_PROTO(183);
WEAKCHK_PROTO(184);
WEAKCHK_PROTO(185);
WEAKCHK_PROTO(186);
WEAKCHK_PROTO(187);
WEAKCHK_PROTO(188);
WEAKCHK_PROTO(189);
WEAKCHK_PROTO(190);
WEAKCHK_PROTO(191);
WEAKCHK_PROTO(192);
WEAKCHK_PROTO(193);
WEAKCHK_PROTO(194);
WEAKCHK_PROTO(195);
WEAKCHK_PROTO(196);
WEAKCHK_PROTO(197);
WEAKCHK_PROTO(198);
WEAKCHK_PROTO(199);
WEAKCHK_PROTO(200);
WEAKCHK_PROTO(201);
WEAKCHK_PROTO(202);
WEAKCHK_PROTO(203);
WEAKCHK_PROTO(204);
WEAKCHK_PROTO(205);
WEAKCHK_PROTO(206);
WEAKCHK_PROTO(207);
WEAKCHK_PROTO(208);
WEAKCHK_PROTO(209);
WEAKCHK_PROTO(210);
WEAKCHK_PROTO(211);
WEAKCHK_PROTO(212);
WEAKCHK_PROTO(213);
WEAKCHK_PROTO(214);
WEAKCHK_PROTO(215);
WEAKCHK_PROTO(216);
WEAKCHK_PROTO(217);
WEAKCHK_PROTO(218);
WEAKCHK_PROTO(219);
WEAKCHK_PROTO(220);
WEAKCHK_PROTO(221);
WEAKCHK_PROTO(222);
WEAKCHK_PROTO(223);
WEAKCHK_PROTO(224);
WEAKCHK_PROTO(225);
WEAKCHK_PROTO(226);
WEAKCHK_PROTO(227);
WEAKCHK_PROTO(228);
WEAKCHK_PROTO(229);
WEAKCHK_PROTO(230);
WEAKCHK_PROTO(231);
WEAKCHK_PROTO(232);
WEAKCHK_PROTO(233);
WEAKCHK_PROTO(234);
WEAKCHK_PROTO(235);
WEAKCHK_PROTO(236);
WEAKCHK_PROTO(237);
WEAKCHK_PROTO(238);
WEAKCHK_PROTO(239);
WEAKCHK_PROTO(240);
WEAKCHK_PROTO(241);
WEAKCHK_PROTO(242);
WEAKCHK_PROTO(243);
WEAKCHK_PROTO(244);
WEAKCHK_PROTO(245);
WEAKCHK_PROTO(246);
WEAKCHK_PROTO(247);
WEAKCHK_PROTO(248);
WEAKCHK_PROTO(249);
WEAKCHK_PROTO(250);
WEAKCHK_PROTO(251);
WEAKCHK_PROTO(252);
WEAKCHK_PROTO(253);
WEAKCHK_PROTO(254);
WEAKCHK_PROTO(255);
WEAKCHK_PROTO(256);
WEAKCHK_PROTO(257);
WEAKCHK_PROTO(258);
WEAKCHK_PROTO(259);
WEAKCHK_PROTO(260);
WEAKCHK_PROTO(261);
WEAKCHK_PROTO(262);
WEAKCHK_PROTO(263);
WEAKCHK_PROTO(264);
WEAKCHK_PROTO(265);
WEAKCHK_PROTO(266);
WEAKCHK_PROTO(267);
WEAKCHK_PROTO(268);
WEAKCHK_PROTO(269);
WEAKCHK_PROTO(270);
WEAKCHK_PROTO(271);
WEAKCHK_PROTO(272);
WEAKCHK_PROTO(273);
WEAKCHK_PROTO(274);
WEAKCHK_PROTO(275);
WEAKCHK_PROTO(276);
WEAKCHK_PROTO(277);
WEAKCHK_PROTO(278);
WEAKCHK_PROTO(279);
WEAKCHK_PROTO(280);
WEAKCHK_PROTO(281);
WEAKCHK_PROTO(282);
WEAKCHK_PROTO(283);
WEAKCHK_PROTO(284);
WEAKCHK_PROTO(285);
WEAKCHK_PROTO(286);
WEAKCHK_PROTO(287);
WEAKCHK_PROTO(288);
WEAKCHK_PROTO(289);
WEAKCHK_PROTO(290);
WEAKCHK_PROTO(291);
WEAKCHK_PROTO(292);
WEAKCHK_PROTO(293);
WEAKCHK_PROTO(294);
WEAKCHK_PROTO(295);
WEAKCHK_PROTO(296);
WEAKCHK_PROTO(297);
WEAKCHK_PROTO(298);
WEAKCHK_PROTO(299);
WEAKCHK_PROTO(300);
WEAKCHK_PROTO(301);
WEAKCHK_PROTO(302);
WEAKCHK_PROTO(303);
WEAKCHK_PROTO(304);
WEAKCHK_PROTO(305);
WEAKCHK_PROTO(306);
WEAKCHK_PROTO(307);
WEAKCHK_PROTO(308);
WEAKCHK_PROTO(309);
WEAKCHK_PROTO(310);
WEAKCHK_PROTO(311);

static rule_checker chk[] = {
    [0] = WEAKCHK(0),
    [1] = WEAKCHK(1),
    [2] = WEAKCHK(2),
    [3] = WEAKCHK(3),
    [4] = WEAKCHK(4),
    [5] = WEAKCHK(5),
    [6] = WEAKCHK(6),
    [7] = WEAKCHK(7),
    [8] = WEAKCHK(8),
    [9] = WEAKCHK(9),
    [10] = WEAKCHK(10),
    [11] = WEAKCHK(11),
    [12] = WEAKCHK(12),
    [13] = WEAKCHK(13),
    [14] = WEAKCHK(14),
    [15] = WEAKCHK(15),
    [16] = WEAKCHK(16),
    [17] = WEAKCHK(17),
    [18] = WEAKCHK(18),
    [19] = WEAKCHK(19),
    [20] = WEAKCHK(20),
    [21] = WEAKCHK(21),
    [22] = WEAKCHK(22),
    [23] = WEAKCHK(23),
    [24] = WEAKCHK(24),
    [25] = WEAKCHK(25),
    [26] = WEAKCHK(26),
    [27] = WEAKCHK(27),
    [28] = WEAKCHK(28),
    [29] = WEAKCHK(29),
    [30] = WEAKCHK(30),
    [31] = WEAKCHK(31),
    [32] = WEAKCHK(32),
    [33] = WEAKCHK(33),
    [34] = WEAKCHK(34),
    [35] = WEAKCHK(35),
    [36] = WEAKCHK(36),
    [37] = WEAKCHK(37),
    [38] = WEAKCHK(38),
    [39] = WEAKCHK(39),
    [40] = WEAKCHK(40),
    [41] = WEAKCHK(41),
    [42] = WEAKCHK(42),
    [43] = WEAKCHK(43),
    [44] = WEAKCHK(44),
    [45] = WEAKCHK(45),
    [46] = WEAKCHK(46),
    [47] = WEAKCHK(47),
    [48] = WEAKCHK(48),
    [49] = WEAKCHK(49),
    [50] = WEAKCHK(50),
    [51] = WEAKCHK(51),
    [52] = WEAKCHK(52),
    [53] = WEAKCHK(53),
    [54] = WEAKCHK(54),
    [55] = WEAKCHK(55),
    [56] = WEAKCHK(56),
    [57] = WEAKCHK(57),
    [58] = WEAKCHK(58),
    [59] = WEAKCHK(59),
    [60] = WEAKCHK(60),
    [61] = WEAKCHK(61),
    [62] = WEAKCHK(62),
    [63] = WEAKCHK(63),
    [64] = WEAKCHK(64),
    [65] = WEAKCHK(65),
    [66] = WEAKCHK(66),
    [67] = WEAKCHK(67),
    [68] = WEAKCHK(68),
    [69] = WEAKCHK(69),
    [70] = WEAKCHK(70),
    [71] = WEAKCHK(71),
    [72] = WEAKCHK(72),
    [73] = WEAKCHK(73),
    [74] = WEAKCHK(74),
    [75] = WEAKCHK(75),
    [76] = WEAKCHK(76),
    [77] = WEAKCHK(77),
    [78] = WEAKCHK(78),
    [79] = WEAKCHK(79),
    [80] = WEAKCHK(80),
    [81] = WEAKCHK(81),
    [82] = WEAKCHK(82),
    [83] = WEAKCHK(83),
    [84] = WEAKCHK(84),
    [85] = WEAKCHK(85),
    [86] = WEAKCHK(86),
    [87] = WEAKCHK(87),
    [88] = WEAKCHK(88),
    [89] = WEAKCHK(89),
    [90] = WEAKCHK(90),
    [91] = WEAKCHK(91),
    [92] = WEAKCHK(92),
    [93] = WEAKCHK(93),
    [94] = WEAKCHK(94),
    [95] = WEAKCHK(95),
    [96] = WEAKCHK(96),
    [97] = WEAKCHK(97),
    [98] = WEAKCHK(98),
    [99] = WEAKCHK(99),
    [100] = WEAKCHK(100),
    [101] = WEAKCHK(101),
    [102] = WEAKCHK(102),
    [103] = WEAKCHK(103),
    [104] = WEAKCHK(104),
    [105] = WEAKCHK(105),
    [106] = WEAKCHK(106),
    [107] = WEAKCHK(107),
    [108] = WEAKCHK(108),
    [109] = WEAKCHK(109),
    [110] = WEAKCHK(110),
    [111] = WEAKCHK(111),
    [112] = WEAKCHK(112),
    [113] = WEAKCHK(113),
    [114] = WEAKCHK(114),
    [115] = WEAKCHK(115),
    [116] = WEAKCHK(116),
    [117] = WEAKCHK(117),
    [118] = WEAKCHK(118),
    [119] = WEAKCHK(119),
    [120] = WEAKCHK(120),
    [121] = WEAKCHK(121),
    [122] = WEAKCHK(122),
    [123] = WEAKCHK(123),
    [124] = WEAKCHK(124),
    [125] = WEAKCHK(125),
    [126] = WEAKCHK(126),
    [127] = WEAKCHK(127),
    [128] = WEAKCHK(128),
    [129] = WEAKCHK(129),
    [130] = WEAKCHK(130),
    [131] = WEAKCHK(131),
    [132] = WEAKCHK(132),
    [133] = WEAKCHK(133),
    [134] = WEAKCHK(134),
    [135] = WEAKCHK(135),
    [136] = WEAKCHK(136),
    [137] = WEAKCHK(137),
    [138] = WEAKCHK(138),
    [139] = WEAKCHK(139),
    [140] = WEAKCHK(140),
    [141] = WEAKCHK(141),
    [142] = WEAKCHK(142),
    [143] = WEAKCHK(143),
    [144] = WEAKCHK(144),
    [145] = WEAKCHK(145),
    [146] = WEAKCHK(146),
    [147] = WEAKCHK(147),
    [148] = WEAKCHK(148),
    [149] = WEAKCHK(149),
    [150] = WEAKCHK(150),
    [151] = WEAKCHK(151),
    [152] = WEAKCHK(152),
    [153] = WEAKCHK(153),
    [154] = WEAKCHK(154),
    [155] = WEAKCHK(155),
    [156] = WEAKCHK(156),
    [157] = WEAKCHK(157),
    [158] = WEAKCHK(158),
    [159] = WEAKCHK(159),
    [160] = WEAKCHK(160),
    [161] = WEAKCHK(161),
    [162] = WEAKCHK(162),
    [163] = WEAKCHK(163),
    [164] = WEAKCHK(164),
    [165] = WEAKCHK(165),
    [166] = WEAKCHK(166),
    [167] = WEAKCHK(167),
    [168] = WEAKCHK(168),
    [169] = WEAKCHK(169),
    [170] = WEAKCHK(170),
    [171] = WEAKCHK(171),
    [172] = WEAKCHK(172),
    [173] = WEAKCHK(173),
    [174] = WEAKCHK(174),
    [175] = WEAKCHK(175),
    [176] = WEAKCHK(176),
    [177] = WEAKCHK(177),
    [178] = WEAKCHK(178),
    [179] = WEAKCHK(179),
    [180] = WEAKCHK(180),
    [181] = WEAKCHK(181),
    [182] = WEAKCHK(182),
    [183] = WEAKCHK(183),
    [184] = WEAKCHK(184),
    [185] = WEAKCHK(185),
    [186] = WEAKCHK(186),
    [187] = WEAKCHK(187),
    [188] = WEAKCHK(188),
    [189] = WEAKCHK(189),
    [190] = WEAKCHK(190),
    [191] = WEAKCHK(191),
    [192] = WEAKCHK(192),
    [193] = WEAKCHK(193),
    [194] = WEAKCHK(194),
    [195] = WEAKCHK(195),
    [196] = WEAKCHK(196),
    [197] = WEAKCHK(197),
    [198] = WEAKCHK(198),
    [199] = WEAKCHK(199),
    [200] = WEAKCHK(200),
    [201] = WEAKCHK(201),
    [202] = WEAKCHK(202),
    [203] = WEAKCHK(203),
    [204] = WEAKCHK(204),
    [205] = WEAKCHK(205),
    [206] = WEAKCHK(206),
    [207] = WEAKCHK(207),
    [208] = WEAKCHK(208),
    [209] = WEAKCHK(209),
    [210] = WEAKCHK(210),
    [211] = WEAKCHK(211),
    [212] = WEAKCHK(212),
    [213] = WEAKCHK(213),
    [214] = WEAKCHK(214),
    [215] = WEAKCHK(215),
    [216] = WEAKCHK(216),
    [217] = WEAKCHK(217),
    [218] = WEAKCHK(218),
    [219] = WEAKCHK(219),
    [220] = WEAKCHK(220),
    [221] = WEAKCHK(221),
    [222] = WEAKCHK(222),
    [223] = WEAKCHK(223),
    [224] = WEAKCHK(224),
    [225] = WEAKCHK(225),
    [226] = WEAKCHK(226),
    [227] = WEAKCHK(227),
    [228] = WEAKCHK(228),
    [229] = WEAKCHK(229),
    [230] = WEAKCHK(230),
    [231] = WEAKCHK(231),
    [232] = WEAKCHK(232),
    [233] = WEAKCHK(233),
    [234] = WEAKCHK(234),
    [235] = WEAKCHK(235),
    [236] = WEAKCHK(236),
    [237] = WEAKCHK(237),
    [238] = WEAKCHK(238),
    [239] = WEAKCHK(239),
    [240] = WEAKCHK(240),
    [241] = WEAKCHK(241),
    [242] = WEAKCHK(242),
    [243] = WEAKCHK(243),
    [244] = WEAKCHK(244),
    [245] = WEAKCHK(245),
    [246] = WEAKCHK(246),
    [247] = WEAKCHK(247),
    [248] = WEAKCHK(248),
    [249] = WEAKCHK(249),
    [250] = WEAKCHK(250),
    [251] = WEAKCHK(251),
    [252] = WEAKCHK(252),
    [253] = WEAKCHK(253),
    [254] = WEAKCHK(254),
    [255] = WEAKCHK(255),
    [256] = WEAKCHK(256),
    [257] = WEAKCHK(257),
    [258] = WEAKCHK(258),
    [259] = WEAKCHK(259),
    [260] = WEAKCHK(260),
    [261] = WEAKCHK(261),
    [262] = WEAKCHK(262),
    [263] = WEAKCHK(263),
    [264] = WEAKCHK(264),
    [265] = WEAKCHK(265),
    [266] = WEAKCHK(266),
    [267] = WEAKCHK(267),
    [268] = WEAKCHK(268),
    [269] = WEAKCHK(269),
    [270] = WEAKCHK(270),
    [271] = WEAKCHK(271),
    [272] = WEAKCHK(272),
    [273] = WEAKCHK(273),
    [274] = WEAKCHK(274),
    [275] = WEAKCHK(275),
    [276] = WEAKCHK(276),
    [277] = WEAKCHK(277),
    [278] = WEAKCHK(278),
    [279] = WEAKCHK(279),
    [280] = WEAKCHK(280),
    [281] = WEAKCHK(281),
    [282] = WEAKCHK(282),
    [283] = WEAKCHK(283),
    [284] = WEAKCHK(284),
    [285] = WEAKCHK(285),
    [286] = WEAKCHK(286),
    [287] = WEAKCHK(287),
    [288] = WEAKCHK(288),
    [289] = WEAKCHK(289),
    [290] = WEAKCHK(290),
    [291] = WEAKCHK(291),
    [292] = WEAKCHK(292),
    [293] = WEAKCHK(293),
    [294] = WEAKCHK(294),
    [295] = WEAKCHK(295),
    [296] = WEAKCHK(296),
    [297] = WEAKCHK(297),
    [298] = WEAKCHK(298),
    [299] = WEAKCHK(299),
    [300] = WEAKCHK(300),
    [301] = WEAKCHK(301),
    [302] = WEAKCHK(302),
    [303] = WEAKCHK(303),
    [304] = WEAKCHK(304),
    [305] = WEAKCHK(305),
    [306] = WEAKCHK(306),
    [307] = WEAKCHK(307),
    [308] = WEAKCHK(308),
    [309] = WEAKCHK(309),
    [310] = WEAKCHK(310),
    [311] = WEAKCHK(311),
};

rule_checker jk_get_checker(int nr_syscall)
{
    if (nr_syscall < 0 && nr_syscall >= num_elem(chk))
        return NULL;

    return chk[nr_syscall];
}

#endif /* CHECKER_H */
